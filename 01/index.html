<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Text Formatter & PDF Creator</title>
  <!-- Load Tailwind CSS for modern styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Load jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    /* Custom font for a clean, modern look */
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 flex items-center justify-center">

  <!-- Main container for the application -->
  <div class="bg-white rounded-xl shadow-2xl p-6 md:p-10 w-full max-w-4xl mx-auto my-8">

    <!-- Application Title -->
    <h1 class="text-3xl md:text-4xl font-extrabold text-center text-gray-800 mb-6 md:mb-8">
      Text Formatter & PDF Creator
    </h1>

    <!-- Input section -->
    <div class="mb-6">
      <label for="inputText" class="block text-gray-700 font-semibold mb-2">
        Enter your text:
      </label>
      <textarea
        id="inputText"
        rows="8"
        placeholder="Paste your text here..."
        class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors"
      ></textarea>
    </div>

    <!-- Configuration options in a responsive grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div>
        <label for="pdfTitle" class="block text-gray-700 font-semibold mb-2">
          PDF Title:
        </label>
        <input
          id="pdfTitle"
          type="text"
          value="Formatted Text"
          placeholder="Enter PDF Title"
          class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors"
        />
      </div>
      <div>
        <label for="lineBreakAfter" class="block text-gray-700 font-semibold mb-2">
          Number of items per line:
        </label>
        <input
          id="lineBreakAfter"
          type="number"
          value="20"
          placeholder="e.g., 20"
          class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors"
        />
      </div>
    </div>

    <!-- Action buttons section -->
    <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4 mb-8">
      <button
        id="processBtn"
        class="w-full sm:w-auto bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-blue-700 transition-colors duration-300"
      >
        <span class="flex items-center justify-center">
          <!-- SVG icon for 'Process Text' -->
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" x2="8" y1="13" y2="13"></line>
            <line x1="16" x2="8" y1="17" y2="17"></line>
            <line x1="10" x2="8" y1="9" y2="9"></line>
          </svg>
          Process Text
        </span>
      </button>
      <button
        id="downloadBtn"
        class="w-full sm:w-auto bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-green-700 transition-colors duration-300"
      >
        <span class="flex items-center justify-center">
          <!-- SVG icon for 'Download PDF' -->
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" x2="12" y1="15" y2="3"></line>
          </svg>
          Download PDF
        </span>
      </button>
    </div>

    <!-- Output section -->
    <div>
      <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-4">
        Formatted Output:
      </h2>
      <div
        id="outputBox"
        class="bg-gray-50 border border-gray-300 rounded-lg p-4 min-h-[200px] whitespace-pre-wrap text-gray-800"
      >
        <p class="text-gray-500 italic">Your formatted text will appear here.</p>
      </div>
    </div>
  </div>

  <!-- Custom Alert/Modal Box -->
  <div id="alertModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center p-4 z-50 hidden">
    <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full transform transition-transform duration-300 scale-100">
      <p id="alertMessage" class="text-lg font-semibold text-gray-800"></p>
      <button onclick="closeAlert()" class="mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition-colors">
        OK
      </button>
    </div>
  </div>

  <script>
    // Get references to all necessary DOM elements
    const inputText = document.getElementById('inputText');
    const pdfTitleInput = document.getElementById('pdfTitle');
    const lineBreakAfterInput = document.getElementById('lineBreakAfter');
    const outputBox = document.getElementById('outputBox');
    const processBtn = document.getElementById('processBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const alertModal = document.getElementById('alertModal');
    const alertMessage = document.getElementById('alertMessage');

    // Helper functions for the custom alert modal
    function showAlert(message) {
      alertMessage.innerText = message;
      alertModal.classList.remove('hidden');
    }

    function closeAlert() {
      alertModal.classList.add('hidden');
    }

    // Function to handle text processing
    function handleProcessText() {
      // Set the button to a disabled state with a loading text
      processBtn.disabled = true;
      processBtn.querySelector('span').innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Processing...';

      // Use a setTimeout to allow the UI to update before processing the text
      setTimeout(() => {
        try {
          const text = inputText.value.trim();
          if (!text) {
            showAlert("Please enter some text to process.");
            outputBox.innerHTML = '<p class="text-gray-500 italic">Your formatted text will appear here.</p>';
            return;
          }

          const breakAfter = parseInt(lineBreakAfterInput.value.trim()) || 20;
          const sentences = text
            .split(/\r?\n/)
            .map(s => s.trim())
            .filter(s => s.length > 0);

          const formattedLines = sentences.map((s, i) => {
            const num = i + 1;
            const lineContent = `(${num}) ${s}`;
            if (breakAfter > 0 && num % breakAfter === 0) {
              return lineContent + '\n';
            }
            return lineContent;
          });

          const numberedText = formattedLines.join(' ');
          outputBox.innerText = numberedText;
        } catch (error) {
          console.error("Error processing text:", error);
          showAlert("An error occurred during text processing. Please check the console for details.");
        } finally {
          // Restore the button state
          processBtn.disabled = false;
          processBtn.querySelector('span').innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>Process Text';
        }
      }, 0);
    }

    // Function to handle PDF download
    function handleDownloadPdf() {
      const formattedText = outputBox.innerText.trim();
      if (!formattedText || formattedText === 'Your formatted text will appear here.') {
        showAlert("Please process the text first before downloading.");
        return;
      }

      const { jsPDF } = window.jspdf;
      const title = pdfTitleInput.value.trim() || "Formatted Text";
      const doc = new jsPDF({ unit: "mm", format: "a4" });
      const pageWidth = doc.internal.pageSize.getWidth();
      const margin = 20;
      const textWidth = pageWidth - margin * 2;

      // Add the title to the PDF
      doc.setFont("helvetica", "bold");
      doc.setFontSize(16);
      doc.text(title, pageWidth / 2, 20, { align: "center" });

      // Set font for the main content
      doc.setFont("times", "normal");
      doc.setFontSize(12);

      // Split the text into lines that fit within the page width
      const wrappedText = doc.splitTextToSize(formattedText, textWidth);
      
      // Add the formatted text to the PDF
      doc.text(wrappedText, margin, 35, { maxWidth: textWidth, align: "justify" });

      doc.save(`${title}.pdf`);
    }

    // Attach event listeners to the buttons
    processBtn.addEventListener('click', handleProcessText);
    downloadBtn.addEventListener('click', handleDownloadPdf);
  </script>

</body>
</html>